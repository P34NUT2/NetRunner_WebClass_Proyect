{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/antonio/proyectos/NetRunner/frontend/context/AuthContext.tsx"],"sourcesContent":["'use client';\n\nimport React, { createContext, useContext, useState, useEffect } from 'react';\n\n// ===== CONFIGURACIÓN =====\nconst API_URL = 'http://localhost:3001';\n\n// ===== TIPOS =====\ninterface User {\n  id: number;\n  username: string;\n  realName: string;\n  role: string;\n  createdAt?: string;\n  profileImg?: string;\n}\n\ninterface AuthContextType {\n  user: User | null;\n  isLoggedIn: boolean;\n  loading: boolean;\n  login: (username: string, password: string) => Promise<void>;\n  register: (username: string, realName: string, password: string) => Promise<void>;\n  logout: () => void;\n}\n\n// ===== CONTEXTO =====\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\n// ===== PROVIDER =====\nexport const AuthProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\n  const [user, setUser] = useState<User | null>(null);\n  const [loading, setLoading] = useState<boolean>(true);\n\n  // Al cargar, revisar si hay usuario guardado\n  useEffect(() => {\n    const savedUser = localStorage.getItem('user');\n    const token = localStorage.getItem('token');\n\n    if (savedUser && token) {\n      try {\n        setUser(JSON.parse(savedUser));\n      } catch (error) {\n        console.error('Error al cargar usuario:', error);\n        localStorage.removeItem('user');\n        localStorage.removeItem('token');\n      }\n    }\n    setLoading(false);\n  }, []);\n\n  // ===== FUNCIÓN LOGIN =====\n  const login = async (username: string, password: string) => {\n    try {\n      const response = await fetch(`${API_URL}/api/auth/login`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        credentials: 'include',\n        body: JSON.stringify({ username, password }),\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Error al iniciar sesión');\n      }\n\n      const data = await response.json();\n\n      // Guardar en localStorage\n      localStorage.setItem('token', data.token);\n      localStorage.setItem('user', JSON.stringify(data.user));\n\n      // Actualizar estado\n      setUser(data.user);\n    } catch (error: any) {\n      console.error('Error en login:', error);\n      throw error;\n    }\n  };\n\n  // ===== FUNCIÓN REGISTER =====\n  const register = async (username: string, realName: string, password: string) => {\n    try {\n      const response = await fetch(`${API_URL}/api/auth/register`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        credentials: 'include',\n        body: JSON.stringify({ username, realName, password }),\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Error al registrarse');\n      }\n\n      const data = await response.json();\n\n      // Guardar en localStorage\n      localStorage.setItem('token', data.token);\n      localStorage.setItem('user', JSON.stringify(data.user));\n\n      // Actualizar estado\n      setUser(data.user);\n    } catch (error: any) {\n      console.error('Error en registro:', error);\n      throw error;\n    }\n  };\n\n  // ===== FUNCIÓN LOGOUT =====\n  const logout = () => {\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    setUser(null);\n  };\n\n  const value = {\n    user,\n    isLoggedIn: user !== null,\n    loading,\n    login,\n    register,\n    logout,\n  };\n\n  return (\n    <AuthContext.Provider value={value}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\n// ===== HOOK =====\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error('useAuth debe usarse dentro de AuthProvider');\n  }\n  return context;\n};\n"],"names":[],"mappings":";;;;;;;AAEA;;;AAFA;;AAIA,4BAA4B;AAC5B,MAAM,UAAU;AAqBhB,uBAAuB;AACvB,MAAM,4BAAc,IAAA,8KAAa,EAA8B;AAGxD,MAAM,eAAwD,CAAC,EAAE,QAAQ,EAAE;;IAChF,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAc;IAC9C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAU;IAEhD,6CAA6C;IAC7C,IAAA,0KAAS;kCAAC;YACR,MAAM,YAAY,aAAa,OAAO,CAAC;YACvC,MAAM,QAAQ,aAAa,OAAO,CAAC;YAEnC,IAAI,aAAa,OAAO;gBACtB,IAAI;oBACF,QAAQ,KAAK,KAAK,CAAC;gBACrB,EAAE,OAAO,OAAO;oBACd,QAAQ,KAAK,CAAC,4BAA4B;oBAC1C,aAAa,UAAU,CAAC;oBACxB,aAAa,UAAU,CAAC;gBAC1B;YACF;YACA,WAAW;QACb;iCAAG,EAAE;IAEL,4BAA4B;IAC5B,MAAM,QAAQ,OAAO,UAAkB;QACrC,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,GAAG,QAAQ,eAAe,CAAC,EAAE;gBACxD,QAAQ;gBACR,SAAS;oBACP,gBAAgB;gBAClB;gBACA,aAAa;gBACb,MAAM,KAAK,SAAS,CAAC;oBAAE;oBAAU;gBAAS;YAC5C;YAEA,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,MAAM,QAAQ,MAAM,SAAS,IAAI;gBACjC,MAAM,IAAI,MAAM,MAAM,KAAK,IAAI;YACjC;YAEA,MAAM,OAAO,MAAM,SAAS,IAAI;YAEhC,0BAA0B;YAC1B,aAAa,OAAO,CAAC,SAAS,KAAK,KAAK;YACxC,aAAa,OAAO,CAAC,QAAQ,KAAK,SAAS,CAAC,KAAK,IAAI;YAErD,oBAAoB;YACpB,QAAQ,KAAK,IAAI;QACnB,EAAE,OAAO,OAAY;YACnB,QAAQ,KAAK,CAAC,mBAAmB;YACjC,MAAM;QACR;IACF;IAEA,+BAA+B;IAC/B,MAAM,WAAW,OAAO,UAAkB,UAAkB;QAC1D,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,GAAG,QAAQ,kBAAkB,CAAC,EAAE;gBAC3D,QAAQ;gBACR,SAAS;oBACP,gBAAgB;gBAClB;gBACA,aAAa;gBACb,MAAM,KAAK,SAAS,CAAC;oBAAE;oBAAU;oBAAU;gBAAS;YACtD;YAEA,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,MAAM,QAAQ,MAAM,SAAS,IAAI;gBACjC,MAAM,IAAI,MAAM,MAAM,KAAK,IAAI;YACjC;YAEA,MAAM,OAAO,MAAM,SAAS,IAAI;YAEhC,0BAA0B;YAC1B,aAAa,OAAO,CAAC,SAAS,KAAK,KAAK;YACxC,aAAa,OAAO,CAAC,QAAQ,KAAK,SAAS,CAAC,KAAK,IAAI;YAErD,oBAAoB;YACpB,QAAQ,KAAK,IAAI;QACnB,EAAE,OAAO,OAAY;YACnB,QAAQ,KAAK,CAAC,sBAAsB;YACpC,MAAM;QACR;IACF;IAEA,6BAA6B;IAC7B,MAAM,SAAS;QACb,aAAa,UAAU,CAAC;QACxB,aAAa,UAAU,CAAC;QACxB,QAAQ;IACV;IAEA,MAAM,QAAQ;QACZ;QACA,YAAY,SAAS;QACrB;QACA;QACA;QACA;IACF;IAEA,qBACE,6LAAC,YAAY,QAAQ;QAAC,OAAO;kBAC1B;;;;;;AAGP;GAxGa;KAAA;AA2GN,MAAM,UAAU;;IACrB,MAAM,UAAU,IAAA,2KAAU,EAAC;IAC3B,IAAI,YAAY,WAAW;QACzB,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;IANa","debugId":null}},
    {"offset": {"line": 143, "column": 0}, "map": {"version":3,"sources":["file:///home/antonio/proyectos/NetRunner/frontend/app/page.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState } from 'react';\nimport Link from 'next/link';\nimport { useRouter } from 'next/navigation';\nimport { FaRobot, FaUser, FaLock, FaIdCard } from 'react-icons/fa';\nimport { useAuth } from '@/context/AuthContext';\n\nexport default function Register() {\n  const router = useRouter();\n  const { register } = useAuth(); // Obtenemos la función de register del contexto\n\n  // Estado del formulario\n  const [formData, setFormData] = useState({\n    username: '',\n    realName: '',\n    password: '',\n    confirmPassword: ''\n  });\n\n  // Estados para mensajes y loading\n  const [error, setError] = useState<string>('');\n  const [success, setSuccess] = useState<string>('');\n  const [loading, setLoading] = useState<boolean>(false);\n\n  // Actualiza los valores del formulario\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setFormData({\n      ...formData,\n      [e.target.name]: e.target.value\n    });\n    // Limpiar errores cuando el usuario empiece a escribir\n    if (error) setError('');\n  };\n\n  // Maneja el envío del formulario\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError('');\n    setSuccess('');\n    setLoading(true);\n\n    // Validaciones del frontend\n    if (formData.password !== formData.confirmPassword) {\n      setError('Las contraseñas no coinciden');\n      setLoading(false);\n      return;\n    }\n\n    if (formData.password.length < 6) {\n      setError('La contraseña debe tener al menos 6 caracteres');\n      setLoading(false);\n      return;\n    }\n\n    try {\n      // Llamar a la función register del contexto (hace fetch al backend)\n      await register(formData.username, formData.realName, formData.password);\n\n      // Si el registro es exitoso\n      setSuccess('¡Cuenta creada exitosamente! Redirigiendo...');\n\n      // Redirigir al chat después de 1 segundo\n      setTimeout(() => {\n        router.push('/');\n      }, 1000);\n\n    } catch (err: any) {\n      // Mostrar el error que devuelve el backend\n      setError(err.message || 'Error al crear la cuenta. Intenta de nuevo.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"bg-black text-gray-100 min-h-screen flex items-center justify-center px-4\">\n      <div className=\"max-w-md w-full\">\n        {/* Logo */}\n        <div className=\"text-center mb-8\">\n          <Link href=\"/\" className=\"inline-flex items-center space-x-2 text-2xl font-bold\">\n            <div className=\"w-10 h-10 bg-red-500 rounded-full flex items-center justify-center\">\n              <FaRobot className=\"text-black\" />\n            </div>\n            <span className=\"text-red-500\">NetRunner<span className=\"text-white\">AI</span></span>\n          </Link>\n        </div>\n\n        {/* Form Card */}\n        <div className=\"bg-gray-900 rounded-lg border border-gray-800 p-8\">\n          <div className=\"text-center mb-6\">\n            <h2 className=\"text-2xl font-bold text-white\">Crear Cuenta</h2>\n            <p className=\"text-gray-400 mt-2\">Únete a NetRunner</p>\n          </div>\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            {/* Mensajes de error y éxito */}\n            {error && (\n              <div className=\"bg-red-500/10 border border-red-500 text-red-500 px-4 py-3 rounded-lg\">\n                {error}\n              </div>\n            )}\n            {success && (\n              <div className=\"bg-green-500/10 border border-green-500 text-green-500 px-4 py-3 rounded-lg\">\n                {success}\n              </div>\n            )}\n\n            <div className=\"relative\">\n              <FaUser className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\" />\n              <input\n                type=\"text\"\n                name=\"username\"\n                placeholder=\"Usuario\"\n                value={formData.username}\n                onChange={handleInputChange}\n                className=\"w-full bg-gray-800 border border-gray-700 rounded-lg px-10 py-3 text-white focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent\"\n                maxLength={20}\n                required\n              />\n            </div>\n\n            <div className=\"relative\">\n              <FaIdCard className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\" />\n              <input\n                type=\"text\"\n                name=\"realName\"\n                placeholder=\"Nombre completo\"\n                value={formData.realName}\n                onChange={handleInputChange}\n                className=\"w-full bg-gray-800 border border-gray-700 rounded-lg px-10 py-3 text-white focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent\"\n                maxLength={50}\n                required\n              />\n            </div>\n\n            <div className=\"relative\">\n              <FaLock className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\" />\n              <input\n                type=\"password\"\n                name=\"password\"\n                placeholder=\"Contraseña\"\n                value={formData.password}\n                onChange={handleInputChange}\n                className=\"w-full bg-gray-800 border border-gray-700 rounded-lg px-10 py-3 text-white focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent\"\n                required\n              />\n            </div>\n\n            <div className=\"relative\">\n              <FaLock className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\" />\n              <input\n                type=\"password\"\n                name=\"confirmPassword\"\n                placeholder=\"Confirmar contraseña\"\n                value={formData.confirmPassword}\n                onChange={handleInputChange}\n                className=\"w-full bg-gray-800 border border-gray-700 rounded-lg px-10 py-3 text-white focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent\"\n                required\n              />\n            </div>\n\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"w-full bg-red-500 hover:bg-red-600 hover:scale-105 hover:shadow-lg hover:shadow-red-500/50 active:scale-95 text-black font-semibold py-3 rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:active:scale-100 disabled:hover:scale-100\"\n            >\n              {loading ? (\n                <span className=\"flex items-center justify-center\">\n                  <svg className=\"animate-spin h-5 w-5 mr-2\" viewBox=\"0 0 24 24\">\n                    <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" fill=\"none\"></circle>\n                    <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                  </svg>\n                  Creando cuenta...\n                </span>\n              ) : 'Crear Cuenta'}\n            </button>\n          </form>\n\n          <div className=\"text-center mt-6\">\n            <p className=\"text-gray-400\">\n              ¿Ya tienes cuenta?\n              <Link href=\"/login\" className=\"text-red-500 hover:text-red-400 active:text-red-600 ml-2 font-medium transition-colors\">\n                Inicia sesión\n              </Link>\n            </p>\n          </div>\n\n          <div className=\"text-center mt-4\">\n            <Link href=\"/\" className=\"text-gray-500 hover:text-gray-400 active:text-gray-300 text-sm transition-colors\">\n              ← Volver al chat\n            </Link>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}